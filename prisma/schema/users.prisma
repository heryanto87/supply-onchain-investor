model UserProfile {
  id     String @id @default(cuid())
  userId String @unique

  fullName    String?
  phoneNumber String?
  countryCode String?
  dateOfBirth DateTime?

  addressLine1 String?
  addressLine2 String?
  city         String?
  region       String?
  postalCode   String?
  country      String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model KycApplication {
  id     String @id @default(cuid())
  userId String

  status KycStatus @default(PENDING)

  submittedAt DateTime?
  reviewedAt  DateTime?

  reviewedByUserId String?
  rejectionReason  String?
  reviewNotes      String? @db.Text
  metadata         Json?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user       User                     @relation("KycOwner", fields: [userId], references: [id], onDelete: Cascade)
  reviewedBy User?                    @relation("KycReviewedBy", fields: [reviewedByUserId], references: [id], onDelete: SetNull)
  documents  KycApplicationDocument[]

  @@index([userId])
  @@index([status])
  @@index([reviewedByUserId])
}

model AuditLog {
  id String @id @default(cuid())

  actorUserId String?
  action      AuditAction

  entityType String
  entityId   String
  metadata   Json?

  createdAt DateTime @default(now())

  actor User? @relation("AuditLogActor", fields: [actorUserId], references: [id], onDelete: SetNull)

  @@index([actorUserId])
  @@index([entityType, entityId])
  @@index([createdAt])
}
